<script>
    document.addEventListener('DOMContentLoaded', function () {

        document.getElementById("btn").addEventListener("click", buttonClickAction);

    });


    function buttonClickAction() {


        let toValidate = {

            name: "이름을 입력하세요.",
            phone: "핸드폰을 입력하세요.",

        };

        let idKeys = Object.keys(toValidate);
        let allValid = true;

        idKeys.forEach(function (id) {
            let isValid = checkIfValid(id, toValidate[id]);
            if (!isValid) {
                allValid = false;
            }
        });

        if (allValid && phoneValidate()) {
            addTenant();
        };

        function checkIfValid(elId, message) {

            let isValid = document.getElementById(elId).checkValidity();

            if (isValid) {
                return true;
            } else {
                M.toast({
                    html: message
                });
                return false;
            };

        };        

        function phoneValidate() {

            let phoneValue = document.getElementById("phone").value;
            var phoneno = /^\d{3}-\d{3,4}-\d{4}$/;
            
            if (phoneValue.match(phoneno)) {
                return true;
            } else {
                M.toast({
                    html: "올바른 핸드폰 번호를 입력하세요."
                });
                return false;
            }
        }


    }


    function addTenant() {

        let tenantInfo = {};

        tenantInfo.name = document.getElementById("name").value;
        tenantInfo.phone = document.getElementById("phone").value;
        tenantInfo.memo = document.getElementById("tenant_memo").value;

        google.script.run.submitTenant(tenantInfo);

        document.getElementById("name").value = "";
        document.getElementById("phone").value = "";
        document.getElementById("tenant_memo").value = "";
        M.updateTextFields();

    }
</script>